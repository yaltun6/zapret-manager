# options for firewall
FWTYPE=iptables
# nftables only : set this to 0 to use pre-nat mode. default is post-nat.
# POSTNAT=0

# options for ipsets
SET_MAXELEM=522288
IPSET_OPT="hashsize 262144 maxelem $SET_MAXELEM"
#IPSET_HOOK="/etc/zapret.ipset.hook"

# options for ip2net. "-4" or "-6" auto added by ipset create script
IP2NET_OPT4="--prefix-length=22-30 --v4-threshold=3/4"
IP2NET_OPT6="--prefix-length=56-64 --v6-threshold=5"

# options for auto hostlist
AUTOHOSTLIST_RETRANS_THRESHOLD=3
AUTOHOSTLIST_FAIL_THRESHOLD=3
AUTOHOSTLIST_FAIL_TIME=60
AUTOHOSTLIST_DEBUGLOG=0

# number of parallel threads for domain list resolves
MDIG_THREADS=30

# compress large lists
GZIP_LISTS=1

# reload command for ip/host lists after update
# LISTS_RELOAD="pfctl -f /etc/pf.conf"

# mark bit used by nfqws to prevent loop
DESYNC_MARK=0x40000000
DESYNC_MARK_POSTNAT=0x20000000

# TPWS settings
TPWS_SOCKS_ENABLE=0
TPPORT_SOCKS=987
TPWS_SOCKS_OPT="
--filter-tcp=80 --methodeol <HOSTLIST> --new
--filter-tcp=443 --split-pos=1,midsld --disorder <HOSTLIST>
"

TPWS_ENABLE=0
TPWS_PORTS=80,443
TPWS_OPT="
--filter-tcp=80 --methodeol <HOSTLIST> --new
--filter-tcp=443 --split-pos=1,midsld --disorder <HOSTLIST>
"

# NFQWS settings
NFQWS_ENABLE=1
NFQWS_PORTS_TCP=80,443
NFQWS_PORTS_UDP=443
NFQWS_TCP_PKT_OUT=$((6+$AUTOHOSTLIST_RETRANS_THRESHOLD))
NFQWS_TCP_PKT_IN=3
NFQWS_UDP_PKT_OUT=$((6+$AUTOHOSTLIST_RETRANS_THRESHOLD))
NFQWS_UDP_PKT_IN=0
NFQWS_PORTS_TCP_KEEPALIVE=80,443
NFQWS_PORTS_UDP_KEEPALIVE=443
NFQWS_OPT="--dpi-desync=fake --dpi-desync-ttl=2 --dpi-desync-fooling=bads --hostspell=hoSt --hostlist-domains=/opt/zapret/nfq/hosts.txt"

# hostlist mode
MODE_FILTER=none

# flow offload mode
FLOWOFFLOAD=donttouch

# LAN/WAN interfaces for non-OpenWRT routers
IFACE_LAN=br0
#IFACE_WAN=
#IFACE_WAN6="ipsec0 wireguard0 he_net"

# apply firewall rules on init scripts
INIT_APPLY_FW=1
#INIT_FW_PRE_UP_HOOK="/etc/firewall.zapret.hook.pre_up"
#INIT_FW_POST_UP_HOOK="/etc/firewall.zapret.hook.post_up"
#INIT_FW_PRE_DOWN_HOOK="/etc/firewall.zapret.hook.pre_down"
#INIT_FW_POST_DOWN_HOOK="/etc/firewall.zapret.hook.post_down"

# disable IPv4/IPv6
#DISABLE_IPV4=1
DISABLE_IPV6=1

# drop ICMP time exceeded messages for nfqws tampered connections
FILTER_TTL_EXPIRED_ICMP=1

# select init script to get ip/host list
#GETLIST=
